\documentclass[12pt]{article}
\usepackage{graphicx}
\usepackage{minted}
\usepackage{hyperref}
\usepackage{float}
\usepackage{pdflscape}
\usepackage{hyperref}
\hypersetup{ colorlinks, citecolor=black,
	filecolor=black,
	linkcolor=black,
	urlcolor=blue,
	pdftitle={M.O.S.I.S Host Software User Guide},
	pdfpagemode=UseThumbs,
}

\begin{document}
\input{../Title_Page/Title Page.tex}
\tableofcontents
\newpage
\section{Installation}
\subsection{Windows}
\newpage
\begin{center}

	\begin{enumerate}
		\item Open a web browser
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-Open-Web-Browser.png}
		      \end{figure}
		\item Go to the repository going to \href{https://github.com/fabiomatos999/M.O.S.I.S}{https://github.com/fabiomatos999/M.O.S.I.S} by clicking here: \href{https://github.com/fabiomatos999/M.O.S.I.S}{link}.
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-Go-To-Repo.png}
		      \end{figure}
		\item Go the releases page on the Github repository:
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-Go-To-Releases.png}
		      \end{figure}
		\item Get Host Software by clicking on the ``M.O.S.I.S\_Host\_Software.zip'' in the latest release (at the time writing v1.0.0)
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-Get-Host-Software.png}
		      \end{figure}
		\item When the ``zip'' file has finished downloading, go to where the file downloaded (in most cases should be the Downloads folder), right click it and select extract all.
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-Extract-Archive.png}
		      \end{figure}
		\item A menu should pop up prompting you to chose where you want to extract the file, click next if you want to extract it in the downloads folder
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-Extract-Archive-Menu.png}
		      \end{figure}
		\item Once the archive has been extracted, click on the search bar at the bottom of the screen and search ``Powershell''. To the right of the top most search result, a series of options should appear, click on the ``Run as the administrator''
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-Open-Search.png}
		      \end{figure}
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-Open-Powershell-As-Admin.png}
		      \end{figure}
		\item If prompted by the following screen, click yes.
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-UAC-Prompt.png}
		      \end{figure}
		\item Once the Powershell has opened, type the following command and then press enter
		      \begin{minted}{ps1}
    Set-ExecutionPolicy unrestricted
  \end{minted}
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-Set-ExecutionPolicy-unrestricted.png}
		      \end{figure}
		\item If prompted to confirm the changes, type ``y'' and press enter
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-Set-ExecutionPolicy-Confim.png}
		      \end{figure}
		\item Close the Powershell by clicking on the X on the top right corner and open Powershell again, but click on the ``open'' button
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-Open-Powershell.png}
		      \end{figure}
		\item Now change directory into where you extracted the host software. Assuming you extracted the host software zip in the Downloads folder, type the following command into the Powershell and press enter.
		      \small\begin{minted}[breaksymbolleft=]{ps1}
    cd .\Downloads\M.O.S.I.S_Host_Software\M.O.S.I.S_Host_Software\App\
  \end{minted}
		      \normalsize
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-cd-Into-Host-Software.png}
		      \end{figure}
		\item Start the host software for the first time by inputting the following command into the Powershell and press enter.
		      \begin{minted}{ps1}
    .\start_app.ps1 -n
  \end{minted}
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-Host-Software-Confim-Run-Once.png}
		      \end{figure}
		\item If prompted by the following screen, click ``yes''
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-UAC-Pompt-wkhtmltopdf.png}
		      \end{figure}
		\item The following installer should appear on screen. Click on the ``I agree'' button.
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-wkhtmltopdf-Menu-1.png}
		      \end{figure}
		\item Click on the ``Install'' button
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-wkhtmltopdf-Menu-2.png}
		      \end{figure}
		\item Wait for the installer to finish
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-wkhtmltopdf-Menu-3.png}
		      \end{figure}
		\item Once the installer finishes, click on the close button
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-wkhtmltopdf-Menu-3-Close.png}
		      \end{figure}
		\item If prompted by the following screen, click ``yes''
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-UAC-Ghostscript.png}
		      \end{figure}
		\item Once the following screen appears, click on the ``next'' button.
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-Ghostscript-Menu-1.png}
		      \end{figure}
		\item Click on the ``I agree'' button
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-Ghostscript-Menu-2.png}
		      \end{figure}
		\item Wait for the installer to complete
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-Ghostscript-Menu-3.png}
		      \end{figure}
		\item Click on the ``Finish'' button.
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-Ghostscript-Menu-4.png}
		      \end{figure}
		\item Once the following screen appears, click on the ``OK'' button.
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-Ghostscript-Menu-5.png}
		      \end{figure}
		\item Once the following installer appears, make sure the ``Use admin privileges when installing py.exe'' and ``Add python.exe to PATH'' and click on the ``Install Now'' button.
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-Python-Menu-1.png}
		      \end{figure}
		\item If prompted by the following screen, click ``yes''
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-UAC-Python-1.png}
		      \end{figure}
		\item Wait for the installer to complete
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-UAC-Python-2.png}
		      \end{figure}
		\item Once this menu appears, click on the ``Disable path length limit''
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-Python-Menu-3.png}
		      \end{figure}
		\item If prompted by the following screen, click ``yes''
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-UAC-Python-2.png}
		      \end{figure}
		\item Once the Python installer completes, the Powershell should appear frozen for a couple of seconds and then print out a bunch of output
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-Poweshell-venv-install-1.png}
		      \end{figure}
		\item Once the host software finishes installing, the following screen may appear, if so click on the ``yes'' button
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-Allow-Python.png}
		      \end{figure}
	\end{enumerate}
	\subsection{Linux}
	\begin{itemize}
		\item Open a web browser
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Linux-Open-Web-Browser.png}
		      \end{figure}
		\item Go to the repository going to \href{https://github.com/fabiomatos999/M.O.S.I.S}{https://github.com/fabiomatos999/M.O.S.I.S} by clicking here: \href{https://github.com/fabiomatos999/M.O.S.I.S}{link}.
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Linux-Go-To-Repo.png}
		      \end{figure}
		\item Go the releases page on the Github repository:
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Linux-Go-To-Releases.png}
		      \end{figure}
		\item Get Host Software by clicking on the ``M.O.S.I.S\_Host\_Software.zip'' in the latest release (at the time writing v1.0.0)
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Linux-Download-Host-Software-Download.png}
		      \end{figure}
		\item Click on the ``zip'' archive once it has finished downloading
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Linux-Open-Host-Software-Archive.png}
		      \end{figure}
		\item Follow the next steps to extract the ``zip'' archive into the downloads folder.
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Linix-Extract-Archive.png}
		      \end{figure}
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Linix-Extract-Archive-2.png}
		      \end{figure}
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Linix-Extract-Archive-3.png}
		      \end{figure}
		\item Open a terminal
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Linux-Open-terminal.png}
		      \end{figure}
		\item Change directory to where the host software was extracted
		      \begin{minted}{bash}
                        cd Downloads/M.O.S.I.S_Host_Software/App
                      \end{minted}
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Linux-cd-Host-Software.png}
		      \end{figure}
		\item Launch the host software by typing the following in the terminal and then pressing enter
		      \begin{minted}{bash}
                       ./start_app.bash -n 
                      \end{minted}
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Linux-Start-Host-Software-First-Time.png}
		      \end{figure}
		\item It should ask you for your password in order to start the installer, write your password and press enter
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Linux-Sudo-Prompt.png}
		      \end{figure}
		\item The rest of the installation will proceed automatically, please wait until it has finished.
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Linux-Host-Software-Installer.png}
		      \end{figure}
		\item You will know the installer had finished when a web browser should open with the host software. If it says that the connection failed, refresh the web page.
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Linux-Host-Software-Install-Finish.png}
		      \end{figure}
	\end{itemize}
	\section{Start Host Software}
	\subsection{Windows}
	\begin{enumerate}
		\item Open Powershell clicking on the ``open'' button
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-Open-Powershell.png}
		      \end{figure}
		\item Now change directory into where you extracted the host software. Assuming you extracted the host software zip in the Downloads folder, type the following command into the Powershell and press enter.
		      \small\begin{minted}[breaksymbolleft=]{ps1}
    cd .\Downloads\M.O.S.I.S_Host_Software\M.O.S.I.S_Host_Software\App\
  \end{minted}
		      \normalsize
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-cd-Into-Host-Software.png}
		      \end{figure}
		\item To start the host software and connect to the microscope, first get the IP address of the device by looking at the field above the status bar of the preview screen of the user interface. Then type the following command into the Powershell, substituting ``IPADDRESS'' with the IP address of the microscope.
		      \begin{minted}{ps1}
    .\start_app.ps1 -i IPADDRESS
  \end{minted}
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-Start-Host-Software-With-IP.png}
		      \end{figure}
		\item If prompted to confirm the ssh key of the microscope, type ``yes'' and press enter.
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-ssh-authenticity-prompt.png}
		      \end{figure}
		\item You will be prompted to input the password of the M.O.S.I.S microscope Raspberry Pi, type ``pi'' and press enter
		      \begin{figure}[H]
			      \includegraphics[width=\textwidth]{Figures/Windows-pi-password-prompt.png}
		      \end{figure}
		\item You should see output on the screen indicating which files are being transferred from the microscope to the host computer, wait until a web browser tab opens with the host software.
	\end{enumerate}
	\subsection{Linux}
	\item Open a terminal
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{Figures/Linux-Open-terminal.png}
	\end{figure}
	\item Change directory to where the host software was extracted
	\begin{minted}{bash}
                        cd Downloads/M.O.S.I.S_Host_Software/App
                      \end{minted}
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{Figures/Linux-cd-Host-Software.png}
	\end{figure}
	\item To start the host software and connect to the microscope, first get the IP address of the device by looking at the field above the status bar of the preview screen of the user interface. Then type the following command into the Powershell, substituting ``IPADDRESS'' with the IP address of the microscope.

	\begin{minted}{bash}
                       ./start_app.bash -i IPADDRESS
                      \end{minted}
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{Figures/Linux-Start-Host-Software-With-IP.png}
	\end{figure}
	\item If prompted to confirm the ssh key of the microscope, type ``yes'' and press enter.
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{Figures/Linux-SSH-Prompt.png}
	\end{figure}
	\item You will be prompted to input the password of the M.O.S.I.S microscope Raspberry Pi, type ``pi'' and press enter
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{Figures/Linux-Pi-Password.png}
	\end{figure}
	\item You should see output on the screen indicating which files are being transferred from the microscope to the host computer, wait until a web browser tab opens with the host software.
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{Figures/Linux-Transfer-Files.png}
	\end{figure}
	\section{Usage}
	\subsection{Viewing All Captured Media}
	In order to view all the media that is currently on the host machine you can either go to ``127.0.0.1:5000'', press the M.O.S.I.S logo on the top left, press the all ``All Images'' button, or click the picture icon in the navigation bar
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{Figures/Viewing-All-Captured-Media.png}
	\end{figure}
	\subsection{Viewing A Specific Captured Media}
	In order to view a specific captured entry, click on the blue test below the entry you would like to see.
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{Figures/Viewing-Specific-media.png}
	\end{figure}
	The blue text provides the following information:
	\begin{enumerate}
		\item ID: Used to search entries
		\item Shot Type: The type of capture done, either SINGLE, BURST, TELESCOPIC, TIMELAPSE or VIDEO
		\item Date stamp: Year-Month-DayTHour-Minute-Second-Millisecond
		\item Illumination Type: The type of illumination used during capture, can either be WHITE, RED, ULTRAVIOLET or NONE
		\item Gain: The camera gain applied in the media capture
		\item Saturation: The camera saturation applied in the media capture
		\item Shutter Speed: The camera shutter speed applied in the media capture
		\item Color Temperature: The camera color temperature speed applied in the media capture
	\end{enumerate}
	\subsubsection{Generated Media}
	For all shot types, all metadata entries have the following information:
	\begin{enumerate}
		\item Date stamp: Year-Month-DayTHour-Minute-Second-Millisecond
		\item Left and Right images
		\item Temperature in Celsius
		\item pH
		\item Pressure in mbar
		\item Dissolved oxygen in mg/L
		\item Stereoscopic image
		\item Tagged stereoscopic image
		\item Threshold stereoscopic image
	\end{enumerate}
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{Figures/L-R-Image.png}
	\end{figure}
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{Figures/Stereo-Image.png}
	\end{figure}
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{Figures/Tagged-Image.png}
	\end{figure}
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{Figures/Threshold-Imae.png}
	\end{figure}
	\subsubsection{Shot Type Specific Media}
	\subsubsection{Burst or Time lapse}
	Burst or Time Lapse entries will have an animated GIF of the captured images that will loop infinitely at the top of the page
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{Figures/GIF.png}
	\end{figure}
	\subsubsection{Telescopic}
	Telescopic images will have a stereoscopic focus stack image on top and the individual left and right focus stack images below that
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{Figures/Stereo-Telescopic-Image.png}
	\end{figure}
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{Figures/L-R-Telescopic-Image.png}
	\end{figure}
	\subsubsection{Video}
	Video entries will have the video at the top while the media metadata are for the individual frames of the video.
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{Figures/Video.png}
	\end{figure}
	\subsection{Search}
	You can search for media entries by four categories: ID, shot type, illumination type and date.
	\subsubsection{ID}
	When searching by ID, you use 4 different patterns:
	\begin{itemize}
		\item Single Values: Looks up an entry if it exists with that specific ID. Example: 1 2 4 5
		\item Comma separated values: Same as single values but easier to read. Example 1,2,4,5
		\item Left ended range: Goes from the given ID to the maximum ID value present in the host software. Example: 3-
		\item Right ended range: Goes from the minimum ID value present in the host software to the given ID. Example -3
		\item Dual ended range: Goes from the left range to the right range. Example: 3-7
	\end{itemize}
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{Figures/Search-By-Id.png}
	\end{figure}
	\subsubsection{Shot Type}
	You can search by shot type. It can either be SINGLE, BURST, TIMELAPSE, TELESCOPIC or VIDEO
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{Figures/Search-By-Shot-Type.png}
	\end{figure}
	\subsubsection{Illumination Type}
	You can search by illumination type. It can either be WHITE, RED, ULTRAVIOLET or NONE.
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{Figures/Search-By-Illumination-Type.png}
	\end{figure}
	\subsubsection{Date}
	Searching by date matches any part of the time stamp. For example we have a time stamp ``2023-11-27T16-14-53.109092'', you can thus date by looking up ``2023'', ``2023-11'', ``2023-11-23'', ``27T16'', ``109092'' or any other continuous sub string.
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{Figures/Search-By-Date.png}
	\end{figure}
	\subsection{Study Profile Creation}
	You can create a study profile for each of the shot types. These study profiles can be uploaded to the microscope to allow for many kinds of captures to be pre configured. All study profiles configurations have the following settings:
	\begin{itemize}
		\item White Balance (K): The color temperature of the image in Kelvin
		\item Illumination Type: The type of illumination to be used. Can either be WHITE, RED, ULTRAVIOLET or NONE
		\item Gain: The camera gain applied in the media capture
		\item Saturation: The camera saturation applied in the media capture
		\item Shutter Speed: The camera shutter speed applied in the media capture
	\end{itemize}
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{Figures/Study-Profile.png}
	\end{figure}
	\subsubsection{Burst}
	Burst images have a parameter called ``Shot Count'' which are the amount of pictures to be taken in the burst. Can be an integer from 2 onward
	\subsubsection{Time Lapse}
	Time lapse images have 2 parameters that can be controlled, time and amount of pictures. Time is the amount on time in minutes that the time lapse will take. Time can either be a floating point number or an integer. The amount of pictures are an integer greater than 1.
	\subsubsection{Telescopic}
	Telescopic images have the ``Zoom Out Count'' parameter which controls the amount of pictures to be taken within the study section which will be converted into a focus stack image.
	\subsubsection{Video}
	Videos have a ``Video Length'' parameter that control the length of the video to be captures.
	\subsection{Study Profile Upload}
	Once a study profile is completed, you can upload it to the microscope by first clicking on the ``Save Study Profile'' button on the navigation bar. Once the page opens you will see a preview of the current study profile and a button to upload the current study profile to the microscope.
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{Figures/Save-Study-Profile.png}
	\end{figure}
	If the study upload button is clicked, go to the Powershell or terminal and input the microscope's Pi password, ``pi'', and press enter. The page will now say that the study was successfully uploaded.
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{Figures/Save-Study-Profile-SSH-Password.png}
	\end{figure}
	\subsection{Remote Deletion Of Media}
	The media captured by the microscope can also be deleted by the host software. This can be done by first clicking on the delete button in the navigation bar. Then you have to confirm twice that you would like to delete all of the media on the microscope.
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{Figures/Remote-Delete.png}
	\end{figure}
	Once both confirmation boxes are selected, press the ``Delete Raspberry Pi Media'' and go to the Powershell or terminal and input the Raspberry Pi password.
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{Figures/Remote-Delete-Confirm.png}
	\end{figure}
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{Figures/Save-Study-Profile-SSH-Password.png}
	\end{figure}
	\subsection{List View}
	The media imported in the host software can also be viewed in a list view instead of the default image preview view. This can be done by either list icon in the navigation bar or by searching specific entries and selecting the list view option.
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{Figures/List-View.png}
	\end{figure}
	\subsection{Export Report}
	Reports can be generated from either the all of the entries inside the host software or just the ones from a search. This can be done by clicking the ``Export to File'' button at the bottom of either the picture preview or list views.
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{Figures/Viewing-All-Captured-Media.png}
	\end{figure}
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{Figures/List-View.png}
	\end{figure}
\end{center}
\end{document}